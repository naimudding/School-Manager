{% extends 'main_website/base.html' %}
{% load static %}
{% load widget_tweaks %}
{% block css %}
<style type="text/css">
	* {
	    margin: 0;
	    padding: 0;
	}

	html {
	    height: 100%;
	}
	.container-fluid {
	    padding-top: 50px;
	}

	/*Background color*/
	#grad1 {
	    background-color: : #9C27B0;
	    background-image: linear-gradient(120deg, #FF4081, #81D4FA);
	}

	/*form styles*/
	#msform {
	    text-align: center;
	    position: relative;
	    margin-top: 20px;
	}

	#msform fieldset .form-card {
	    background: white;
	    border: 0 none;
	    border-radius: 0px;
	    box-shadow: 0 2px 2px 2px rgba(0, 0, 0, 0.2);
	    padding: 20px 40px 30px 40px;
	    box-sizing: border-box;
	    width: 94%;
	    margin: 0 3% 20px 3%;

	    /*stacking fieldsets above each other*/
	    position: relative;
	}

	#msform fieldset {
	    background: white;
	    border: 0 none;
	    border-radius: 0.5rem;
	    box-sizing: border-box;
	    width: 100%;
	    margin: 0;
	    padding-bottom: 20px;

	    /*stacking fieldsets above each other*/
	    position: relative;
	}

	/*Hide all except first fieldset*/
	#msform fieldset:not(:first-of-type) {
	    display: none;
	}

	#msform fieldset .form-card {
	    text-align: left;
	    color: #9E9E9E;
	}

/*	#msform input, #msform textarea {
	    padding: 0px 8px 4px 8px;
	    border: none;
	    border-bottom: 1px solid #ccc;
	    border-radius: 0px;
	    margin-bottom: 25px;
	    margin-top: 2px;
	    width: 100%;
	    box-sizing: border-box;
	    font-family: montserrat;
	    color: #2C3E50;
	    font-size: 16px;
	    letter-spacing: 1px;
	}*/

/*	#msform input:focus, #msform textarea:focus {
	    -moz-box-shadow: none !important;
	    -webkit-box-shadow: none !important;
	    box-shadow: none !important;
	    border: none;
	    font-weight: bold;
	    border-bottom: 2px solid skyblue;
	    outline-width: 0;
	}*/

	/*Blue Buttons*/
	#msform .action-button {
	    width: 100px;
	    background: skyblue;
	    font-weight: bold;
	    color: white;
	    border: 0 none;
	    border-radius: 0px;
	    cursor: pointer;
	    padding: 10px 5px;
	    margin: 10px 5px;
	}

	#msform .action-button:hover, #msform .action-button:focus {
	    box-shadow: 0 0 0 2px white, 0 0 0 3px skyblue;
	}

	/*Previous Buttons*/
	#msform .action-button-previous {
	    width: 100px;
	    background: #616161;
	    font-weight: bold;
	    color: white;
	    border: 0 none;
	    border-radius: 0px;
	    cursor: pointer;
	    padding: 10px 5px;
	    margin: 10px 5px;
	}

	#msform .action-button-previous:hover, #msform .action-button-previous:focus {
	    box-shadow: 0 0 0 2px white, 0 0 0 3px #616161;
	}

	/*Dropdown List Exp Date*/
	select.list-dt {
	    border: none;
	    outline: 0;
	    border-bottom: 1px solid #ccc;
	    padding: 2px 5px 3px 5px;
	    margin: 2px;
	}

	select.list-dt:focus {
	    border-bottom: 2px solid skyblue;
	}

	/*The background card*/
	.card {
	    z-index: 0;
	    border: none;
	    border-radius: 0.5rem;
	    position: relative;
	}

	/*FieldSet headings*/
	.fs-title {
	    font-size: 25px;
	    color: #2C3E50;
	    margin-bottom: 10px;
	    font-weight: bold;
	    text-align: left;
	}

	/*progressbar*/
	#progressbar {
	    margin-bottom: 30px;
	    overflow: hidden;
	    color: lightgrey;
	}

	#progressbar .active {
	    color: #000000;
	}

	#progressbar li {
	    list-style-type: none;
	    font-size: 12px;
	    width: 25%;
	    float: left;
	    position: relative;
	}

	/*Icons in the ProgressBar*/
	#progressbar #account:before {
	    font-family: FontAwesome;
	    content: "\f023";
	}

	#progressbar #personal:before {
	    font-family: FontAwesome;
	    content: "\f007";
	}

	#progressbar #payment:before {
	    font-family: FontAwesome;
	    content: "\f09d";
	}

	#progressbar #confirm:before {
	    font-family: FontAwesome;
	    content: "\f00c";
	}

	/*ProgressBar before any progress*/
	#progressbar li:before {
	    width: 50px;
	    height: 50px;
	    line-height: 45px;
	    display: block;
	    font-size: 18px;
	    color: #ffffff;
	    background: lightgray;
	    border-radius: 50%;
	    margin: 0 auto 10px auto;
	    padding: 2px;
	}

	/*ProgressBar connectors*/
	#progressbar li:after {
	    content: '';
	    width: 100%;
	    height: 2px;
	    background: lightgray;
	    position: absolute;
	    left: 0;
	    top: 25px;
	    z-index: -1;
	}

	/*Color number of the step and the connector before it*/
	#progressbar li.active:before, #progressbar li.active:after {
	    background: skyblue;
	}

	/*Imaged Radio Buttons*/
	.radio-group {
	    position: relative;
	    margin-bottom: 25px;
	}

	.radio {
	    display:inline-block;
	    width: 204;
	    height: 104;
	    border-radius: 0;
	    background: lightblue;
	    box-shadow: 0 2px 2px 2px rgba(0, 0, 0, 0.2);
	    box-sizing: border-box;
	    cursor:pointer;
	    margin: 8px 2px; 
	}

	.radio:hover {
	    box-shadow: 2px 2px 2px 2px rgba(0, 0, 0, 0.3);
	}

	.radio.selected {
	    box-shadow: 1px 1px 2px 2px rgba(0, 0, 0, 0.1);
	}

	/*Fit image in bootstrap div*/
	.fit-image{
	    width: 100%;
	    object-fit: cover;
	}
</style>
{% endblock %}

{% block content %}
<!-- MultiStep Form -->

<div class="container-fluid" id="grad1">

    <div class="row justify-content-center mt-0">
        <div class="col-11 col-sm-9 col-md-7 col-lg-6 text-center p-0 mt-3 mb-2">
            <div class="card px-0 pt-4 pb-0 mt-3 mb-3">
                <h2><strong>Add Student</strong></h2>
                <div class="row">
                    <div class="col-md-12 mx-0">
                        <form id="msform" method="POST" action="" enctype="multipart/form-data">
                            <!-- progressbar -->
                            {% csrf_token %}  
                            <ul id="progressbar">
                                <li class="active" id="account"><strong>Personal Information</strong></li>
                                <li id="personal"><strong>Guardian Information</strong></li>
                                <li id="payment"><strong>Previous Study</strong></li>
                                <li id="confirm"><strong>Upload Documents</strong></li>
                            </ul>
                            <!-- fieldsets -->
                            {% for message in messages %}
		  						{% if 'error' in message.tags %}
	                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
								  <strong>{{ message }}</strong>
								  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								    <span aria-hidden="true">&times;</span>
								  </button>
								</div>
								{% endif %}
								{% if 'success' in message.tags %}
								<div class="alert alert-success alert-dismissible fade show" role="alert">
								  <strong>{{ message }}</strong>
								  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								    <span aria-hidden="true">&times;</span>
								  </button>
								</div>
								{% endif %}
							{% endfor %}
                            <fieldset>
                                <div class="form-card">
                                    <h2 class="fs-title">Personal Information*</h2>
                                    <div class="form-group row">
                                    	<label class="col-3">Full Name*</label>
									    <input type="text" class="form-control col-9" name="fullname" value='{{ student_form.fullname.value|default_if_none:"" }}'>
									 </div>
									 <div class="form-group row">
									 	<label class="col-3">SR Number*</label>
									    <input type="text" class="form-control col-9" name="sr_no" value='{{ student_form.sr_no.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Old SR Number</label>
									    <input type="text" class="form-control col-9" name="old_sr_no" value='{{ student_form.old_sr_no.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
									    <label class="col-3">Enter Class*</label>
									    <select class="form-control col-9" name="class_name" id="class">
									      <option value="">------</option>
									      <option>Nurani Qayda</option>
									      <option>Nazra</option>
									      <option>Hifz</option>
									      <option>Farsi</option>
									      <option>Alimiyat</option>
									    </select>
									</div>
									<div class="form-group row">
									    <label class="col-3">Current Status*</label>
									    <select class="form-control col-9" name="status" id="status">
									      <option>Active</option>
									      <option>Graduated</option>
									      <option>Absconded</option>
									      <option>Transferred</option>
									    </select>
									</div>
									<div class="form-group row">
										<label class="col-3">Date of Birth*</label>
									    <input type="date" class="form-control col-9" name="date_of_birth" placeholder="DD/MM/YYYY" value='{{ student_form.date_of_birth.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Date of Joining</label>
									    <input type="date" class="form-control col-9" name="date_of_joining" placeholder="DD/MM/YYYY" value='{{ student_form.date_of_joining.value|default_if_none:"" }}'>
									</div>
                                </div>
                                <input type="button" name="next" class="next action-button filled-button" value="Next Step"/>
                            </fieldset>
                            <fieldset>
                                <div class="form-card">
                                    <h2 class="fs-title">Guardian Information*</h2>
                                    <div class="form-group row">
                                    	<label class="col-3">Guardian*</label>
                                    	<select class="form-control col-2" name="guardian_relation" id="relation">
									      <option>Father</option>
									      <option>Mother</option>
									      <option>CareTaker</option>
									    </select>
									    <input type="text" class="form-control col-6 ml-2" name="guardian_name" value='{{ student_form.guardian_name.value|default_if_none:"" }}'>
									 </div>
									 <div class="form-group row">
                                    	<label class="col-3">Father Mobile*</label>
									    <input type="number" class="form-control col-9" name="father_mobile" value='{{ student_form.father_mobile.value|default_if_none:"" }}'>
									 </div>
									 <div class="form-group row">
									 	<label class="col-3">Business</label>
									    <input type="text" class="form-control col-9" name="father_biz" value='{{ student_form.father_biz.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Caste</label>
									    <input type="text" class="form-control col-9" name="caste" value='{{ student_form.caste.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">City & Pincode</label>
										<input type="text" class="form-control col-4" name="city" placeholder="City" value='{{ student_form.city.value|default_if_none:"" }}'>
									    <input type="text" class="form-control col-4 ml-2" name="pincode" placeholder="Pincode" value='{{ student_form.pincode.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Full Address</label>
									    <textarea class="form-control col-9" name="address">{{ student_form.address.value|default_if_none:"" }}</textarea>
									</div>
                                </div>
                                <input type="button" name="previous" class="previous action-button-previous" value="Previous"/>
                                <input type="button" name="next" class="next action-button filled-button" value="Next Step"/>
                            </fieldset>
                            <fieldset>
                            	<div class="form-card">
                                    <h2 class="fs-title">Previous Study</h2>
                                    <div class="form-group row">
                                    	<label class="col-3">Previous Class</label>
									    <input type="text" class="form-control col-9" name="prev_study" value='{{ prev_study_form.prev_study.value|default_if_none:"" }}'>
									 </div>
									 <div class="form-group row">
									 	<label class="col-3">Previous Result</label>
									    <input type="text" class="form-control col-9" name="prev_marks" value='{{ prev_study_form.prev_marks.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Date of Leaving:</label>
									    <input type="date" class="form-control col-9" name="pre_date_of_leaving" placeholder="DD/MM/YYYY" value='{{ prev_study_form.pre_date_of_leaving.value|default_if_none:"" }}'>
									</div>
									<div class="form-group row">
										<label class="col-3">Reason of Leaving:</label>
									    <textarea class="form-control col-9" name="prev_reason_of_leaving">{{ prev_study_form.prev_reason_of_leaving.value|default_if_none:"" }}</textarea>
									</div>
									<div class="form-group row">
									    <label class="col-3">Is TC Issued</label>
									    <select class="form-control col-9" name="is_prev_tc_issued" id="tc">
									      <option>Yes</option>
									      <option>No</option>
									    </select>
									</div>
                                </div>
                                <input type="button" name="previous" class="previous action-button-previous" value="Previous"/>
                                <input type="button" name="next" class="next action-button" value="Next Step"/>
                            </fieldset>
                            <fieldset>
                            	<div class="form-card">
                                    <h2 class="fs-title">Upload Documents</h2>
                                    <div class="form-group row">
									    <input type="text" class="form-control col-4 mr-2" value="Passport Size Picture" disabled>
									    <input type="file" accept=".png,.jpeg,.jpg" class="form-control col-4" name="picture">
									</div>
									<div class="form-group row">
									    <input type="text" class="form-control col-4 mr-2" value="Aadhar Card" disabled>
									    <input type="file" class="form-control col-4" name="aadhar">
									</div>
									 {{ formset.management_form }}
									 {% for form in formset %}
                                    	<div class="form-group row formset">
                                    		{% for field in form %}
                                    		{% if not field.label == "Student" %}
                                    			{% render_field field class="form-control col-4  mr-2" placeholder=field.label %}
                                    		{% endif %}
                                    		{% for error in field.errors %}
												 <div class="invalid-feedback" style='display: block;'>{{ error }}</div>
											{% endfor %}
                                    		{% endfor %}
                                    		<a href="#" class="ml-5 doc_delete"><i class="fa fa-minus-square" style="font-size:38px;"></i></a>
									    	
									 	</div>
									{% endfor %} 
                                </div>
                                <input type="button" name="previous" class="previous action-button-previous" value="Previous"/>
                                <button type="submit" class="btn btn-primary btn-shadow font-weight-bold mr-2" form="msform">Submit</button>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block java_script %}
<script type="text/javascript">
	document.getElementById("class").value = '{{ student_form.class_name.value|default_if_none:"" }}';
	document.getElementById("status").value = '{{ student_form.status.value|default_if_none:"Active" }}';
	document.getElementById("relation").value = '{{ student_form.guardian_relation.value|default_if_none:"Father" }}';
	document.getElementById("tc").value = '{{ prev_study_form.is_prev_tc_issued.value|default_if_none:"" }}';
</script>
<script src="{% static 'js/jquery.formset.js' %}"></script>
<script>
    $('.formset').formset({
        addText: 'Add',
        deleteText: 'Remove'
    });
</script>
<script type="text/javascript">

	$(document).on("click",".doc_delete", function(){
		$(this).parent().remove()
	})

	$(document).ready(function(){
	    
	var current_fs, next_fs, previous_fs; //fieldsets
	var opacity;

	$(".next").click(function(){
	    
	    current_fs = $(this).parent();
	    next_fs = $(this).parent().next();
	    
	    //Add Class Active
	    $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");
	    
	    //show the next fieldset
	    next_fs.show(); 
	    //hide the current fieldset with style
	    current_fs.animate({opacity: 0}, {
	        step: function(now) {
	            // for making fielset appear animation
	            opacity = 1 - now;

	            current_fs.css({
	                'display': 'none',
	                'position': 'relative'
	            });
	            next_fs.css({'opacity': opacity});
	        }, 
	        duration: 600
	    });
	});

	$(".previous").click(function(){
	    
	    current_fs = $(this).parent();
	    previous_fs = $(this).parent().prev();
	    
	    //Remove class active
	    $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");
	    
	    //show the previous fieldset
	    previous_fs.show();

	    //hide the current fieldset with style
	    current_fs.animate({opacity: 0}, {
	        step: function(now) {
	            // for making fielset appear animation
	            opacity = 1 - now;

	            current_fs.css({
	                'display': 'none',
	                'position': 'relative'
	            });
	            previous_fs.css({'opacity': opacity});
	        }, 
	        duration: 600
	    });
	});

	$('.radio-group .radio').click(function(){
	    $(this).parent().find('.radio').removeClass('selected');
	    $(this).addClass('selected');
	});

	$(".submit").click(function(){
	    return false;
	})
	    
	});
</script>
{% endblock %}
